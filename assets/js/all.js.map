{"version":3,"sources":["all.js","AuthorizationHeader.js"],"names":["subscriptionInfoForm","document","querySelector","subscriptionEmail","subscriptionBtn","addEventListener","reMail","value","swal","test","reset","attractionsList","attractionsData","ScenicSpotModal","renderAttractionsList","data","str","length","innerHTML","forEach","item","OpenTime","undefined","ScenicSpotID","Picture","PictureUrl1","PictureDescription1","ScenicSpotName","Phone","getAllAttractionsList","url","axios","get","headers","GetAuthorizationHeader","then","res","error","console","log","e","modalBtn","relatedTarget","id","getAttribute","img","title","description","openTime","phone","setAttribute","textContent","DescriptionDetail","init","authUrl","parameter","grant_type","client_id","client_secret","post","Qs","stringify","defaults","common","Authorization","access_token","err"],"mappings":"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","file":"all.js","sourcesContent":["/* global axios */\n\n/* 訂閱區塊JS */\nconst subscriptionInfoForm = document.querySelector('.subscriptionInfo-form');\n// 訂閱input輸入\nconst subscriptionEmail = document.querySelector('.subscription-email');\n// 訂閱按鈕\nconst subscriptionBtn = document.querySelector('.subscription-btn');\n\n// 監聽訂閱按鈕\nsubscriptionBtn.addEventListener('click', () => {\n    // eslint-disable-next-line no-useless-escape\n    // Email 格式驗證\n    const reMail = /^([a-zA-Z0-9_\\.\\-\\+])+\\@(([a-zA-Z0-9\\-])+\\.)+([a-zA-Z0-9]{2,4})+$/;\n    const { value } = subscriptionEmail;\n    // console.log(value);\n    if (value === '') {\n        swal('出錯了！', '未輸入Email', 'error');\n    } else if (!reMail.test(value)) {\n        swal('出錯了！', 'Email格式錯誤', 'error');\n    } else {\n        swal('訂閱成功！', '將定期發送相關觀光資訊', 'success');\n        subscriptionInfoForm.reset();\n    }\n});\n\n// API 的 filter 用法：例如: 沒有圖片時\n// $filter=Picture/PictureUrl1 ne null\n\n// 宣告列表\nconst attractionsList = document.querySelector('.attractions-list');\n\n// 存放觀光景點資料\nlet attractionsData = [];\n\n// Modal\nconst ScenicSpotModal = document.querySelector('#attractionsScenicSpotModal');\n\n//  渲染列表\nfunction renderAttractionsList(data) {\n  let str = '';\n  // console.log(data.length);\n  if (data.length === 0) {\n    str = `<li class=\"d-flex justify-content-center align-items-center\">\n    <span class=\"material-icons text-sm-m text-md-lg text-2xl me-4\">\n      error_outline\n    </span>\n    <p class=\"text-sm-m text-md-lg text-2xl text-center\">目前沒有資料\n    </p>\n  </li>`;\n    attractionsList.innerHTML = str;\n  } else {\n    data.forEach((item) => {\n      // console.log(item);\n\n      // 若API有提供圖片網址，但圖片網址失效時，使用 onerror=\"this.src='https://i.ibb.co/5WGrGkK/404.jpg'\" 替代\n      // if (JSON.stringify(item.Picture) === '{}') {\n      //   return;\n      // }\n      if (item.OpenTime === undefined) {\n        str += `<li class=\"col-md-6 col-lg-4 d-flex flex-column\">\n        <div class=\"card my-2 my-md-4 my-lg-6 card-shadow-hover h-100\">\n          <a href=\"\" class=\"stretched-link\" data-bs-toggle=\"modal\" data-bs-target=\"#attractionsScenicSpotModal\"\n            data-bs-whatever=\"${item.ScenicSpotID}\">\n            <img src=\"${item.Picture.PictureUrl1}\"\n              onerror=\"this.src='https://i.ibb.co/hR0Sb7y/404.jpg';this.onerror = null\"\n              class=\"card-img-top img-fluid\" alt=\".${item.Picture.PictureDescription1}\">\n          </a>\n          <div class=\"card-body\">\n            <h4 class=\"text-sm-m text-lg text-warning\">${item.ScenicSpotName}</h4>\n            <div class=\"d-flex\">\n              <p class=\"text-s text-success mt-2\">開放時間：未提供相關時間</p>\n            </div>\n            <p class=\"text-s text-success mt-2\">連絡電話：${item.Phone}</p>\n          </div>\n        </div>\n      </li>`;\n      } else {\n        str += `<li class=\"col-md-6 col-lg-4 d-flex flex-column\">\n        <div class=\"card my-2 my-md-4 my-lg-6 card-shadow-hover h-100\">\n          <a href=\"\" class=\"stretched-link\" data-bs-toggle=\"modal\" data-bs-target=\"#attractionsScenicSpotModal\"\n            data-bs-whatever=\"${item.ScenicSpotID}\">\n            <img src=\"${item.Picture.PictureUrl1}\"\n              onerror=\"this.src='https://i.ibb.co/hR0Sb7y/404.jpg';this.onerror = null\"\n              class=\"card-img-top img-fluid\" alt=\".${item.Picture.PictureDescription1}\">\n          </a>\n          <div class=\"card-body\">\n            <h4 class=\"text-sm-m text-lg text-warning\">${item.ScenicSpotName}</h4>\n            <p class=\"text-s text-success mt-2\">開放時間：${item.OpenTime}</p>\n            <p class=\"text-s text-success mt-2\">連絡電話：${item.Phone}</p>\n          </div>\n        </div>\n      </li>`;\n      }\n    });\n    attractionsList.innerHTML = str;\n  }\n}\n\n// 取得預設景點資料\nfunction getAllAttractionsList() {\n  const url = 'https://tdx.transportdata.tw/api/basic/v2/Tourism/ScenicSpot/Taipei?$filter=contains(Class1,%27%E9%81%8A%E6%86%A9%E9%A1%9E%27)&$top=6&$skip=9&$format=JSON';\n  axios.get(\n    url,\n    {\n      headers: GetAuthorizationHeader(),\n    },\n    ).then((res) => {\n      attractionsData = res.data;\n      renderAttractionsList(attractionsData);\n      // console.log(attractionsData);\n    })\n    .catch((error) => {\n      console.log(error);\n    });\n}\n\n// 監聽\nScenicSpotModal.addEventListener('show.bs.modal', (e) => {\n  // console.log(e.relatedTarget);\n  const modalBtn = e.relatedTarget; // 被點擊的元素可作為事件的 relatedTarget 屬性\n  const id = modalBtn.getAttribute('data-bs-whatever');\n  const img = ScenicSpotModal.querySelector('.card-img-top');\n  const title = ScenicSpotModal.querySelector('.card-title');\n  const description = ScenicSpotModal.querySelector('.card-text');\n  const openTime = ScenicSpotModal.querySelector('.openTime');\n  const phone = ScenicSpotModal.querySelector('.phone');\n\n  attractionsData.forEach((item) => {\n    // console.log(item);\n    if (item.ScenicSpotID === id) {\n      img.setAttribute('src', `${item.Picture.PictureUrl1}`);\n      title.textContent = `${item.ScenicSpotName}`;\n      description.textContent = `${item.DescriptionDetail}`;\n      if (item.OpenTime === undefined) {\n        // eslint-disable-next-line no-param-reassign\n        item.OpenTime = '未提供';\n      }\n      openTime.innerHTML = `\n        <span class=\"material-icons-outlined me-2\">\n          schedule\n        </span>\n        ${item.OpenTime}\n      `;\n      phone.innerHTML = `\n        <span class=\"material-icons me-2\">\n          call\n        </span>\n        <a href=\"tel:+${item.Phone}\">${item.Phone}</a>\n      `;\n    }\n  });\n});\n\n// ------ 初始化\nfunction init() {\n  // 呼叫取得token函式\n  // GetAuthorizationHeader();\n\n  // 呼叫取得預設觀光景點資料\n  getAllAttractionsList();\n}\n\ninit();\n","/* global axios */\n\n// 請自行更換 client_id 與 client_secret\n// GetApiResponse() 中 axios.get('URL') 的 URL 可替換成想要取得的網址。\n\n// API 認證，取得 token\n// eslint-disable-next-line no-unused-vars\nfunction GetAuthorizationHeader() {\n    const authUrl = 'https://tdx.transportdata.tw/auth/realms/TDXConnect/protocol/openid-connect/token';\n\n      const parameter = {\n      grant_type: 'client_credentials',\n      client_id: 'apog780212-3c7005de-321a-4555',\n      client_secret: '4408c630-a7ff-4f57-8728-f4642ee5f932',\n    };\n\n    axios.post(authUrl,Qs.stringify(parameter))\n      .then((res) => {\n        axios.defaults.headers.common.Authorization = `Bearer ${res.data.access_token}`;\n      })\n      .catch((err) => {\n        console.log(err);\n      });\n}\n"]}